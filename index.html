<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ЗАМОРОЗКА</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: white;
      color: #003366;
      margin: 0;
      padding: 20px;
      max-width: 500px;
      margin: 0 auto;
    }
    .header {
      text-align: center;
      margin-bottom: 20px;
    }
    h1 {
      font-size: 24px;
      font-weight: bold;
      color: #003366;
    }
    p.subtitle {
      font-size: 14px;
      color: #666;
      margin-top: 8px;
    }
    label {
      display: block;
      margin: 12px 0 6px;
      font-size: 14px;
      color: #333;
    }
    input[type="number"] {
      width: 100%;
      padding: 12px;
      border: 2px solid #ddd;
      border-radius: 8px;
      font-size: 16px;
      background: white;
      color: #333;
      text-align: right;
    }
    .buttons {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 8px;
      margin: 12px 0;
    }
    .buttons button {
      padding: 12px;
      border: 2px solid #e0f0ff;
      border-radius: 8px;
      background: #f0f9ff;
      font-weight: 600;
      cursor: pointer;
      color: #003366;
    }
    .buttons button.selected {
      background: #cce5ff;
      border-color: #007bff;
      color: #007bff;
    }

    .slider-container {
      margin: 12px 0;
    }
    .slider-label {
      display: flex;
      justify-content: space-between;
      font-size: 12px;
      color: #666;
    }
    input[type="range"] {
      width: 100%;
      height: 6px;
      -webkit-appearance: none;
      background: #e0e0e0;
      border-radius: 3px;
      outline: none;
    }
    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 20px;
      height: 20px;
      background: #007bff;
      border-radius: 50%;
      cursor: pointer;
    }

    .summary {
      margin: 20px 0;
      padding: 12px;
      background: #f8f8f8;
      border-radius: 8px;
      display: none;
    }
    .checkbox {
      display: flex;
      align-items: center;
      margin: 12px 0;
    }
    .checkbox input {
      margin-right: 8px;
      width: 18px;
      height: 18px;
    }
    .checkbox label {
      font-size: 14px;
      margin: 0;
      color: #333;
    }
    #freezeBtn {
      width: 100%;
      padding: 12px;
      background: #66BB6A;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      margin-top: 20px;
    }
    #freezeBtn:disabled {
      background: #cccccc;
      cursor: not-allowed;
    }
    .footer {
      margin-top: 20px;
      text-align: center;
      font-size: 12px;
      color: #666;
    }
    .footer a {
      color: #007bff;
      text-decoration: none;
    }

    .arrow-btn {
  width: 36px;
  height: 36px;
  border: 1px solid #ddd;
  background: white;
  border-radius: 6px;
  font-weight: bold;
  color: #007bff;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
}
.arrow-btn:hover {
  background: #f0f9ff;
}
  </style>
</head>
<body>
  <div class="header">
    <h1>ЗАМОРОЗКА</h1>
  </div>

  <p class="subtitle">Заморозь деньги — сохрани цель</p>

  <label>Сумма (₽)</label>
  <input type="number" id="amount" min="100" placeholder="1000" value="1000">

 <label>Срок заморозки</label>

<!-- Быстрые кнопки -->
<div class="buttons" id="presetButtons">
  <button data-hours="3">3 ч</button>
  <button data-hours="6">6 ч</button>
  <button data-hours="12">12 ч</button>
  <button data-hours="24">24 ч</button>
  <button data-hours="48">2 д</button>
  <button data-hours="168">7 д</button>
</div>

<!-- Стрелки + слайдер -->
<div style="display: flex; align-items: center; gap: 10px; margin: 12px 0;">
  <button class="arrow-btn" onclick="adjustTime(-1)">◀</button>
  
  <div style="flex: 1;">
    <div class="slider-label">
      <span>1 ч</span>
      <span id="sliderValue">12 ч</span>
    </div>
    <input type="range" id="timeSlider" min="1" max="168" value="12" oninput="updateFromSlider()">
  </div>

  <button class="arrow-btn" onclick="adjustTime(1)">▶</button>
</div>

  <div class="summary" id="summary">
    Вы замораживаете <strong id="sumDisplay">1000</strong> ₽ на <strong id="timeDisplay">12 ч</strong>.
  </div>

  <div class="checkbox">
    <input type="checkbox" id="agreement" required>
    <label>Я понимаю: деньги будут заблокированы на моей карте и недоступны для траты до окончания срока.</label>
  </div>

  <button id="freezeBtn" onclick="pay()" disabled>Заморозить</button>

<!-- Информация для Робокассы -->
  <div class="robokassa-info">
    <strong>Информация о сервисе:</strong><br>
    Услуга по временному блокированию средств на карте пользователя для финансового самоконтроля.<br>
    Стоимость услуги: 0 ₽. Услуга предоставляется бесплатно. Реализации товаров не происходит.<br>
    Условия: средства временно блокируются на карте (pre-auth) и автоматически разблокируются через заданный срок (до 7 дней). Возврат средств не требуется — деньги не списываются с карты.
  </div>

  <div class="footer">
    <a href="/oferta.html" target="_blank">Публичная оферта</a>
  </div>

 <script>
  let selectedHours = 12;

  // Подсветка кнопок
  function selectPreset(hours) {
    selectedHours = hours;
    document.getElementById('timeSlider').value = hours;
    document.getElementById('sliderValue').textContent = formatTime(hours);
    
    // Сброс подсветки
    document.querySelectorAll('#presetButtons button').forEach(btn => {
      btn.classList.remove('selected');
    });
    // Подсветка текущей кнопки
    const activeBtn = document.querySelector(`#presetButtons button[data-hours="${hours}"]`);
    if (activeBtn) activeBtn.classList.add('selected');
    
    updateSummary();
    check();
  }

  // Обновление из слайдера
  function updateFromSlider() {
    const hours = parseInt(document.getElementById('timeSlider').value);
    selectedHours = hours;
    document.getElementById('sliderValue').textContent = formatTime(hours);
    
    // Снимаем подсветку, если выбрали не через кнопку
    document.querySelectorAll('#presetButtons button').forEach(btn => {
      btn.classList.remove('selected');
    });
    
    updateSummary();
    check();
  }

  // Стрелки
  function adjustTime(delta) {
    let newHours = selectedHours + delta;
    if (newHours < 1) newHours = 1;
    if (newHours > 168) newHours = 168;
    selectPreset(newHours); // используем общую логику
  }

  // Формат времени
  function formatTime(hours) {
    if (hours < 24) return `${hours} ч`;
    const days = Math.floor(hours / 24);
    const remainder = hours % 24;
    if (remainder === 0) return `${days} д`;
    return `${days} д ${remainder} ч`;
  }

  // Обновление итога
  function updateSummary() {
    const amount = document.getElementById('amount').value;
    document.getElementById('sumDisplay').textContent = amount;
    document.getElementById('timeDisplay').textContent = formatTime(selectedHours);
    document.getElementById('summary').style.display = 'block';
  }

  // Проверка активности кнопки
  function check() {
    const ok = selectedHours >= 1 && document.getElementById('amount').value >= 100 && document.getElementById('agreement').checked;
    document.getElementById('freezeBtn').disabled = !ok;
  }

  // Привязка событий к кнопкам
  document.querySelectorAll('#presetButtons button').forEach(btn => {
    btn.addEventListener('click', () => {
      const hours = parseInt(btn.getAttribute('data-hours'));
      selectPreset(hours);
    });
  });

  // Обработчики ввода
  document.getElementById('amount').oninput = () => { updateSummary(); check(); };
  document.getElementById('agreement').onchange = check;

  // Инициализация
  updateSummary();
</script>
</body>
</html>
